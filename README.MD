

# –°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—ã–π pet-–ø—Ä–æ–µ–∫—Ç

## üß± –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç	–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
–Ø–∑—ã–∫	Java 17

–§—Ä–µ–π–º–≤–æ—Ä–∫	Spring Boot, 
Spring Cloud

Service Discovery	

Netflix Eureka

API Gateway	

Spring Cloud Gateway

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è	JWT 

Spring Security

–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö	PostgreSQL , Redis

–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π	Apache Kafka

–°–±–æ—Ä–∫–∞	Maven
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è	Docker / Docker Compose (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)




## üóÇÔ∏è –°–æ—Å—Ç–∞–≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

–ü—Ä–æ–µ–∫—Ç —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤:

–°–µ—Ä–≤–∏—Å	–û–ø–∏—Å–∞–Ω–∏–µ
Eureka Server	–°–µ—Ä–≤–∏—Å —Ä–µ–µ—Å—Ç—Ä–∞ (Service Discovery). –í—Å–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ Eureka.

API Gateway	–ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤. –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, CORS, JWT-–≤–∞–ª–∏–¥–∞—Ü–∏—è.

User Service	–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

Email Service	–û—Ç–ø—Ä–∞–≤–∫–∞ email-—Å–æ–æ–±—â–µ–Ω–∏–π (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Kafka.

Profile Service	–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

Post Service	–°–æ–∑–¥–∞–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤, –ª–µ–Ω—Ç–∞ –Ω–æ–≤–æ—Å—Ç–µ–π.

Message Service	–õ–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —á–∞—Ç—ã.

Channel Service	–°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏/–≥—Ä—É–ø–ø–∞–º–∏.

–û–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ —á—ë—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏ JWT, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Redis.



## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ JWT

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ JSON Web Tokens (JWT).

–¢–æ–∫–µ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç: userId, email, –Ω–∞–±–æ—Ä —Ä–æ–ª–µ–π (ROLE_USER, ROLE_ADMIN), —Ñ–ª–∞–≥–∏ isEnabled, accountNonLocked.

API Gateway –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å —Ç–æ–∫–µ–Ω–∞, –µ–≥–æ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤ Redis blacklist –∏ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω—É–∂–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (—á–µ—Ä–µ–∑ Eureka, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏).

Redis –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:

–¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤;

–¥–ª—è –æ—Ç–º–µ—Ç–æ–∫ –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤).

–¥–ª—è ttl –∫–æ–¥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏



## üîÅ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤

–°–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: REST API —á–µ—Ä–µ–∑ Eureka + Gateway.

–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ: Apache Kafka.

–ù–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è User Service –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ Kafka, Email Service –ø–æ–ª—É—á–∞–µ—Ç –µ–≥–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.

–ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –µ—â—ë –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è feign client , –Ω–æ —Å—Ç–∞—Ä–∞–µ–º—Å—è –æ—Ç–æ–π—Ç–∏ –æ—Ç –Ω–µ–≥–æ.




## üß© User Service ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

User Service –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á—ë—Ç–Ω—ã–º–∏ –∑–∞–ø–∏—Å—è–º–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –≤—ã–¥–∞—á—É JWT, —Å–º–µ–Ω—É –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Kafka –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∏—Å–µ–º.



## üì¶ –°—É—â–Ω–æ—Å—Ç—å Users

–ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è:

email, password, name, secondName, birthDay

enable ‚Äî –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –ª–∏ –∞–∫–∫–∞—É–Ω—Ç (–ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è email)

accountNonLocked ‚Äî –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º / —Å–∏—Å—Ç–µ–º–æ–π)

confirmationCode, passwordResetCode, emailChangeCode ‚Äî –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∫–æ–¥—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è

ttlEmailCode, passwordResetCodeExpiryDate ‚Äî —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ –∫–æ–¥–æ–≤

refreshToken ‚Äî —Ç–µ–∫—É—â–∏–π refresh‚Äë—Ç–æ–∫–µ–Ω (—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î)

avatarId ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–≤–∞—Ç–∞—Ä–∞ (—Å—Å—ã–ª–∫–∞ –Ω–∞ Image)

roles ‚Äî –Ω–∞–±–æ—Ä —Ä–æ–ª–µ–π (ROLE_USER, ROLE_ADMIN)

pendingEmail ‚Äî –Ω–æ–≤—ã–π email, –æ–∂–∏–¥–∞—é—â–∏–π –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è



## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ JWT

Access‚Äë—Ç–æ–∫–µ–Ω (—Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ 15 –º–∏–Ω—É—Ç):

Refresh‚Äë—Ç–æ–∫–µ–Ω  —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ email.

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤ ‚Äî JwtService
generateAuthToken() ‚Äî —Å–æ–∑–¥–∞—ë—Ç –ø–∞—Ä—É access + refresh –ø—Ä–∏ –≤—Ö–æ–¥–µ.

refreshBaseToken() ‚Äî –≤—ã–¥–∞—ë—Ç –Ω–æ–≤—ã–π access‚Äë—Ç–æ–∫–µ–Ω, –æ—Å—Ç–∞–≤–ª—è—è refresh‚Äë—Ç–æ–∫–µ–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—Ö–æ–¥–µ, –µ—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω).

refreshRefreshToken() ‚Äî –æ–±–Ω–æ–≤–ª—è–µ—Ç refresh‚Äë—Ç–æ–∫–µ–Ω, –µ—Å–ª–∏ –¥–æ –µ–≥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –æ—Å—Ç–∞–ª–æ—Å—å –º–µ–Ω—å—à–µ 7 –¥–Ω–µ–π , —Ç–æ –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.



## üõ°Ô∏è –§–∏–ª—å—Ç—Ä –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Äî JwtFilter

–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–∫–µ–Ω –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization: Bearer ....

–í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ –ø–æ–ª—É—á–∞–µ—Ç TokenData (userId, email, —Ä–æ–ª–∏, —Å—Ç–∞—Ç—É—Å—ã).

–°–æ–∑–¥–∞—ë—Ç CustomUserDetails —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Authentication –≤ SecurityContextHolder.

–ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –¥–∞–ª—å—à–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ ‚Äî SecurityConfig

–û—Ç–∫–ª—é—á–µ–Ω—ã CSRF, HTTP Basic.

–ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (permitAll):

/api/users/registration

/api/users/confirm-registration

/api/users/resend-confirm-registration

/api/users/send-password-resetCode

/api/users/reset-password-with-code

/api/users/send-email-reset-code

/api/users/resend-email-resetCode

/auth/**

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

Stateless-—Å–µ—Å—Å–∏–∏, –¥–æ–±–∞–≤–ª–µ–Ω JwtFilter –ø–µ—Ä–µ–¥ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º.

## üë§ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ä–µ—Å—É—Ä—Å–∞ ‚Äî SecurityService

isOwner(Long id) ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç ID –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º.

isOwnerForEmail(String email) ‚Äî —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç email.

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ @PreAuthorize("@securityService.isOwner(#id)") –¥–ª—è –∑–∞—â–∏—Ç—ã –º–µ—Ç–æ–¥–æ–≤.



## üß† Redis ‚Äî —á—ë—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

RedisJwtService —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–≤—É–º—è —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:

–ö–ª—é—á	–ó–Ω–∞—á–µ–Ω–∏–µ	TTL	–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
blk:token:{token}	"true"	–æ—Å—Ç–∞—Ç–æ–∫ –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞	–û—Ç–æ–∑–≤–∞–Ω–Ω—ã–µ access‚Äë—Ç–æ–∫–µ–Ω—ã (–ø—Ä–∏ logout)
blk:user:{userId}	"banned"	20 –º–∏–Ω—É—Ç	–§–ª–∞–≥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
–ü—Ä–∏ logout / fullLogout access‚Äë—Ç–æ–∫–µ–Ω –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ blacklist –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è –µ–≥–æ —Å—Ä–æ–∫–∞.

–ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (accountNonLocked = false) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–ª—é—á blk:user:{userId}. API Gateway –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —ç—Ç–æ—Ç —Ñ–ª–∞–≥ –∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã.

–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª—è–µ—Ç –∫–ª—é—á –∏–∑ Redis.

–¢–∞–º –µ—â—ë ttl –¥–ª—è –∫–æ–¥–∞  —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏–∫—Ä—É—á–∏–≤–∞—é


## ‚úâÔ∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Email Service —á–µ—Ä–µ–∑ Kafka

EmailKafkaProducer –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ —Ç–æ–ø–∏–∫ email-topic –æ–±—ä–µ–∫—Ç EmailRequestDto:

`json
{
"to": "user@example.com",
"code": "ABC123",
"type": "CONFIRMATION" | "PASSWORD_RESET"
}`
Email Service ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π —á–∏—Ç–∞–µ—Ç —ç—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∏—Å—å–º–∞.

–°–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –ø—Ä–∏:

—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;

–ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è;

–∑–∞–ø—Ä–æ—Å–µ —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è;

–∑–∞–ø—Ä–æ—Å–µ —Å–º–µ–Ω—ã email.


## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–∑–Ω–µ—Å‚Äë–æ–ø–µ—Ä–∞—Ü–∏–∏ User Service

–ú–µ—Ç–æ–¥	–û–ø–∏—Å–∞–Ω–∏–µ
createUsers	–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: —Ö–µ—à–∏—Ä—É–µ—Ç –ø–∞—Ä–æ–ª—å, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–¥, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç Kafka

confirmRegistration	–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç –ø–æ –∫–æ–¥—É (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ä–æ–∫)

singIn	–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –≤—ã–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–æ–≤, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh‚Äë—Ç–æ–∫–µ–Ω–∞ –≤ –ë–î

logout / fullLogout	–î–æ–±–∞–≤–ª–µ–Ω–∏–µ access‚Äë—Ç–æ–∫–µ–Ω–∞ –≤ blacklist, —Å–±—Ä–æ—Å refresh‚Äë—Ç–æ–∫–µ–Ω–∞ (fullLogout)

refreshToken	–í—ã–¥–∞—á–∞ –Ω–æ–≤–æ–π –ø–∞—Ä—ã —Ç–æ–∫–µ–Ω–æ–≤ –ø–æ –¥–µ–π—Å—Ç–≤—É—é—â–µ–º—É refresh‚Äë—Ç–æ–∫–µ–Ω—É

sendPasswordResetCode	–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ –ø–∞—Ä–æ–ª—è, –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ Kafka

resetPasswordWithCode	–°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è –ø—Ä–∏ –≤–µ—Ä–Ω–æ–º –∫–æ–¥–µ

sendEmailResetCode	–ò–Ω–∏—Ü–∏–∞—Ü–∏—è —Å–º–µ–Ω—ã email 

confirmEmailChange	–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ email

addAvatar / addPhotos	–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–≤—è–∑—å —Å —Å—É—â–Ω–æ—Å—Ç—å—é Image

updateRoles	–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

accountBlocking	–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ / —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (accountNonLocked)

changeAccountStatus	–ê–∫—Ç–∏–≤–∞—Ü–∏—è / –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ (enable)

getPrivetProfile	–ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–≤–ª–∞–¥–µ–ª–µ—Ü)

findPublicProfile	–ü—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–¥–æ—Å—Ç—É–ø–µ–Ω –≤—Å–µ–º)


## üß¨ –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (User Service + Gateway + Redis + Kafka)


[Client]

‚îÄ‚ñ∫ [API Gateway]
‚îÄ‚ñ∫ **JWT validation, blacklist check**
‚îÄ‚ñ∫ **route to User Service**

[User Service]
**‚îÄ‚ñ∫ JwtFilter ‚Äì —É—Å—Ç–∞–Ω–æ–≤–∫–∞ SecurityContext
‚îÄ‚ñ∫ RedisJwtService ‚Äì –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ blacklist –ø—Ä–∏ logout
‚îÄ‚ñ∫ UserRepository ‚Äì —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
‚îÄ‚ñ∫ EmailKafkaProducer ‚Äì –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ Kafka**

[Email Service]
**‚îÄ‚ñ∫ Kafka consumer ‚Äì –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∏—Å–µ–º**

üìå **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ –∫–æ–¥—É)**
Refresh‚Äë—Ç–æ–∫–µ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ ¬´—Ä–∞–∑–ª–æ–≥–∏–Ω–∏—Ç—å¬ª –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–±—Ä–æ—Å–∏–≤ –µ–≥–æ.

–ü—Ä–æ–¥–ª–µ–Ω–∏–µ refresh‚Äë—Ç–æ–∫–µ–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å –≤–∞–ª–∏–¥–Ω—ã–º access‚Äë—Ç–æ–∫–µ–Ω–æ–º (–≤ JwtFilter). –ï—Å–ª–∏ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è refresh‚Äë—Ç–æ–∫–µ–Ω–∞ –æ—Å—Ç–∞–ª–æ—Å—å < 7 –¥–Ω–µ–π ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–æ–≤—ã–π, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î.

–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —É—Ä–æ–≤–Ω–µ Gateway –∏ User Service —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Redis.

–ö–æ–¥—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ (TTL), —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å—É—â–Ω–æ—Å—Ç–∏ Redis (–Ω–æ –Ω–µ –≤—Å–µ , –ø–æ–∫–∞ –Ω–µ–¥–æ–ø–µ–ª–∏–ª)

–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ @PreAuthorize —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º SecurityService ‚Äî –≥–∏–±–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ä–µ—Å—É—Ä—Å–∞–º.




